<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>refinery: refinery</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">refinery</div>
   <div id="projectbrief">RAW file processor</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>refinery </h1>  </div>
</div>
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="Introduction"></a>
Introduction</h2>
<p>Refinery reads RAW photograph files as input and provides usable RGB (or other format) data, which is suitable for combining with other imaging libraries.</p>
<h2><a class="anchor" id="Installing"></a>
Installing</h2>
<ol>
<li>
Download the source: <code>git clone git://github.com/adamh/refinery.git</code> </li>
<li>
Install CMake and Boost: <code>sudo apt-get install libboost-dev cmake</code> </li>
<li>
Change into the source directory and type <code>cmake -D CMAKE_BUILD_TYPE=Release .</code> </li>
<li>
<code>make</code> (to change options, install and run <code>ccmake</code>). </li>
<li>
<code>sudo make install</code> </li>
</ol>
<p>This will install headers, a shared library, and the <code>raw2ppm</code> program.</p>
<p>If you also have SWIG 2.0 and Python development headers installed, then Python bindings will be built and installed. With these, you can combine refinery with the Python Imaging Library (PIL) for image-processing power.</p>
<p>You may also install Exiv2 and run cmake with <code>-D LICENCE_GPL=ON</code> to compile Exiv2 support. Where the built-in <a class="el" href="classrefinery_1_1DcrawExifData.html" title="Exif parser copied from dcraw.c.">DcrawExifData</a> doesn't work, Exiv2 might.</p>
<h2><a class="anchor" id="Running"></a>
Running</h2>
<p>This is a library, not a program. You can use <code>-I/path/to/refinery</code> and <code>-lrefinery</code> to compile programs.</p>
<p>One program, <code>raw2ppm</code>, accompanies this code. Call it with <code>raw2ppm [RAWFILE] outfile.ppm</code>. It converts a RAW file to a PPM and is intended as an example, not an everyday tool. You can link refinery with other libraries (such as a JPEG-writing one) to create more powerful tools.</p>
<h2><a class="anchor" id="Using"></a>
Using</h2>
<p>Use <code>-I/path/to/refinery</code> and <code>-lrefinery</code> to compile programs. You can include &lt;<a class="el" href="refinery_8h_source.html">refinery/refinery.h</a>&gt; for some basic tools, or just include the particular files you need.</p>
<p>Use <code>util/raw2ppm.cc</code> as an example. There's also <code>util/licensed/gpl/convert.py</code> which shows how to use Python to extend classes and take advantage of PIL.</p>
<p>Raw decoding entails a series of steps; here's a typical chain:</p>
<ol>
<li>
Unpack the Exif data (use <a class="el" href="classrefinery_1_1DcrawExifData.html" title="Exif parser copied from dcraw.c.">DcrawExifData</a> or <a class="el" href="classrefinery_1_1Exiv2ExifData.html" title="Uses Exiv2 to supply Exif data.">Exiv2ExifData</a>). </li>
<li>
Unpack the raw data (use <a class="el" href="classrefinery_1_1ImageReader.html" title="Returns Image instances based on stream input and Exif data.">ImageReader</a>). Unless you're using a Foveon camera, you now have a grayscale <a class="el" href="classrefinery_1_1Image.html" title="A grid of pixels with accompanying metadata.">Image</a>. </li>
<li>
Scale it to fill its data-type (for instance, scaling 12-bit to 16-bit) (use <a class="el" href="classrefinery_1_1ScaleColorsFilter.html" title="Scale an Image to fill its data-type.">ScaleColorsFilter</a>). </li>
<li>
Interpolate the missing colors (use <a class="el" href="classrefinery_1_1Interpolator.html" title="Transforms a sensor image to an RGB or CMYK image.">Interpolator</a>). Now you have multi-color <a class="el" href="classrefinery_1_1Image.html" title="A grid of pixels with accompanying metadata.">Image</a>. </li>
<li>
Convert from the camera colorspace to sRGB (use <a class="el" href="classrefinery_1_1ConvertToRgbFilter.html" title="Convert an Image from camera colors to sRGB.">ConvertToRgbFilter</a>). </li>
<li>
Gamma-correct the image (use <a class="el" href="classrefinery_1_1Histogram.html" title="Says, for each color, how many of a picture&#39;s pixels hold each value.">Histogram</a>, <a class="el" href="classrefinery_1_1GammaCurve.html" title="A gamma curve, mapping input scalars to output scalars.">GammaCurve</a> and <a class="el" href="classrefinery_1_1GammaFilter.html" title="Gamma-correct an Image with a GammaCurve.">GammaFilter</a>). </li>
<li>
Flip and rotate the image if needed (nothing in refinery for this right now). </li>
<li>
Save the image (use <a class="el" href="classrefinery_1_1ImageWriter.html" title="Outputs images in PPM format.">ImageWriter</a>). </li>
</ol>
<p>Depending on your intents, you might want to add more steps. That's okay, since the image data is easy to copy from <a class="el" href="classrefinery_1_1Image.html#a0b62c058ae0281c8451bd7db3ac547a6" title="A pointer to the first pixel in the image, useful for iterating.">Image::pixels()</a>.</p>
<h2><a class="anchor" id="License"></a>
License</h2>
<p>This code is public domain, except for anything that links to Exiv2, which is GPL. </p>
</div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Sun Feb 20 2011 18:38:25 for refinery by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
